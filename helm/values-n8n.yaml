# n8n Helm Values
# Secrets are managed via Vault and injected via k8s/templates/apps/n8n-secret.yaml.j2

n8n:
  namespace: keybuzz
  image:
    repository: n8nio/n8n
    tag: latest
  replicas: 2
  
  # Secrets are retrieved from Vault via AppRole
  # See k8s/templates/apps/n8n-secret.yaml.j2
  vault:
    address: "https://vault.keybuzz.io:8200"
    verify: false
    approle:
      role_id_file: "/vault/n8n-role-id"
      secret_id_file: "/vault/n8n-secret-id"
  
  # Placeholder values - actual values come from Vault
  secrets:
    rabbitmq_url: "{{ vault_lookup('kv/keybuzz/apps/n8n:rabbitmq-url') }}"
    redis_url: "{{ vault_lookup('kv/keybuzz/apps/n8n:redis-url') }}"
    webhook_secret: "{{ vault_lookup('kv/keybuzz/apps/n8n:webhook-secret') }}"
    jwt_secret: "{{ vault_lookup('kv/keybuzz/apps/n8n:jwt-secret') }}"

