apiVersion: v1
kind: Secret
metadata:
  name: chatwoot-secrets
  namespace: {{ chatwoot_namespace | default('keybuzz') }}
type: Opaque
data:
  database-url: "{{ lookup('community.hashi_vault.hashi_vault', 'secret=kv/keybuzz/apps/chatwoot:database-url', url='https://vault.keybuzz.io:8200', auth_method='approle', role_id=lookup('file', '/vault/chatwoot-role-id'), secret_id=lookup('file', '/vault/chatwoot-secret-id'), verify=False) | b64encode }}"
  redis-url: "{{ lookup('community.hashi_vault.hashi_vault', 'secret=kv/keybuzz/apps/chatwoot:redis-url', url='https://vault.keybuzz.io:8200', auth_method='approle', role_id=lookup('file', '/vault/chatwoot-role-id'), secret_id=lookup('file', '/vault/chatwoot-secret-id'), verify=False) | b64encode }}"
  rabbitmq-url: "{{ lookup('community.hashi_vault.hashi_vault', 'secret=kv/keybuzz/apps/chatwoot:rabbitmq-url', url='https://vault.keybuzz.io:8200', auth_method='approle', role_id=lookup('file', '/vault/chatwoot-role-id'), secret_id=lookup('file', '/vault/chatwoot-secret-id'), verify=False) | b64encode }}"
  smtp-password: "{{ lookup('community.hashi_vault.hashi_vault', 'secret=kv/keybuzz/apps/chatwoot:smtp-password', url='https://vault.keybuzz.io:8200', auth_method='approle', role_id=lookup('file', '/vault/chatwoot-role-id'), secret_id=lookup('file', '/vault/chatwoot-secret-id'), verify=False) | b64encode }}"

