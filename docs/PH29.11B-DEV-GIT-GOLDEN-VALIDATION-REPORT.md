# PH29.11B - Validation Build "Git = GOLDEN" (DEV ONLY)

## Objectif
Prouver que le build depuis Git contient les features GOLDEN.

---

## 1. Preuves Version

### DEV Client
```json
{"app":"app","version":"0.5.11-ph29.3-parity","gitSha":"791b28a","buildDate":"2026-02-05T21:50:41.041542Z"}
```

### PROD Client (GOLDEN reference)
```json
{"app":"app","version":"0.5.10-channels-polish","gitSha":"ef961c8","buildDate":"2026-02-03T14:08:14.254442Z"}
```

### Pod DEV
```
Pod: keybuzz-client-86497b95c7-q2td7
Image: ghcr.io/keybuzzio/keybuzz-client:dev-ph29.11-test-2026-02-05
```

---

## 2. Verification Octopia DEV

### API Backend DEV
```bash
curl -sk "https://api-dev.keybuzz.io/octopia/status?tenantId=ecomlg-001"
```
```json
{
  "connected": false,
  "delegationInstructions": "Pour connecter Cdiscount via Octopia, deleguez vos acces a KeyBuzz sur le Seller Portal Octopia.",
  "apiCredentialsUrl": "https://seller.octopia.com/manager/accounts"
}
```
**Status: OK** - L'API Octopia DEV repond correctement.

### Channels Registry DEV
```bash
curl -sk https://client-dev.keybuzz.io/api/channels/registry
```
```json
[
  {"id": "amazon", "label": "Amazon Seller Central", "status": "available"},
  {"id": "octopia", "label": "Octopia (Cdiscount)", "status": "available"},
  {"id": "fnac", "label": "Fnac Marketplace", "status": "coming_soon"},
  {"id": "email", "label": "Email", "status": "coming_soon"}
]
```
**Status: OK** - Octopia est marque comme "available" dans le registry.

### Routes Octopia dans l'image
```
/app/.next/server/app/api/octopia/test/route.js
/app/.next/server/app/api/octopia/sync/run/route.js
/app/.next/server/app/api/octopia/connect/route.js
/app/.next/server/app/api/octopia/status/route.js
/app/.next/server/app/api/octopia/disconnect/route.js
```
**Status: OK** - Toutes les routes Octopia sont presentes.

---

## 3. Verification IA Contexte

### Analyse du code source
Le service AI (`src/services/ai.service.ts`) supporte `additionalContext` dans le payload:
```typescript
payload?: { messages?: Array<{ role: string; content: string }>; additionalContext?: string }
```

### UI Exposee
**Constat**: Apres analyse du code source GOLDEN (commit 4229048) et du build DEV:
- Le champ `additionalContext` est supporte par l'API
- **Mais l'UI (AISuggestionSlideOver, AIDecisionPanel) n'expose pas de champ "Contexte supplementaire"**
- Cette feature n'existait pas dans l'image GOLDEN originale

**Status: NON APPLICABLE** - Le champ "Contexte supplementaire" n'existe pas dans le code GOLDEN.

---

## 4. Verification Split-Brain Resolu

### Bundles statiques DEV
```bash
# Recherche de references a api.keybuzz.io (PROD)
grep -r 'api.keybuzz.io' /app/.next/static
# Resultat: AUCUNE REFERENCE
```

```bash
# Recherche de references a api-dev.keybuzz.io (DEV)
grep -r 'api-dev.keybuzz.io' /app/.next/static
# Resultat: REFERENCES TROUVEES (comportement attendu)
```

**Status: OK** - Le build DEV ne contient aucune reference a l'API PROD.

### Variables d'environnement au build
Le build utilise:
- `NEXT_PUBLIC_API_URL=https://api-dev.keybuzz.io`
- `NEXT_PUBLIC_API_BASE_URL=https://api-dev.keybuzz.io`

---

## 5. Resume Parite Features

| Feature | GOLDEN | DEV Build | Status |
|---------|--------|-----------|--------|
| Routes Octopia API | Oui | Oui | OK |
| Octopia UI (Channels) | Oui | Oui | OK |
| Service Octopia | Oui | Oui | OK |
| Channels Registry | Oui | Oui | OK |
| TenantProvider | Oui | Oui | OK |
| Split-brain resolu | N/A | Oui | OK |
| Champ IA "Contexte supp." | Non | Non | N/A |

---

## 6. Conclusion

**Le build DEV depuis Git est equivalent au GOLDEN pour les features existantes:**
- Octopia integration complete
- Channels registry fonctionnel
- TenantProvider comme source unique
- Split-brain API URL resolu

**Note importante**: Le champ "Contexte supplementaire" pour l'IA n'existait pas dans le code GOLDEN original. Si cette feature est souhaitee, elle doit etre developpee.

---
Date: 2026-02-05
Status: VALIDE (DEV ONLY)